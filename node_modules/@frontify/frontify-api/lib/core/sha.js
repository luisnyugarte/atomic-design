var crypto = require('crypto');
var fs = require('fs');

module.exports = function (filename) {
  return new Promise(function(resolve, reject) {
    var sum = crypto.createHash('sha1');
    var fileStream = fs.createReadStream(filename);

    fileStream.on('error', function (err) {
      throw err;
    });

    fileStream.on('data', function (chunk) {
      try {
        sum.update(chunk);
      } catch (err) {
        throw err;
      }
    });

    fileStream.on('end', function () {
      resolve(sum.digest('hex'));
    });
  });
};